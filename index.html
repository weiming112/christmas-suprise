<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Christmas Surprise</title>
<link href="https://fonts.googleapis.com/css2?family=Mountains+of+Christmas:wght@400;700&family=Playfair+Display:ital,wght@0,400;1,400&display=swap" rel="stylesheet">
<style>
  :root {
    --gold: #ffd700;
    --red: #ff3333;
    --green: #2e7d32;
  }
  
  * { box-sizing: border-box; margin: 0; padding: 0; }

  html {
    scroll-behavior: smooth;
    scroll-snap-type: y mandatory;
    height: 100%;
    overflow-y: scroll;
    background: #050505;
  }

  body {
    font-family: 'Playfair Display', serif;
    background: #050505;
    color: #f0f0f0;
    overflow-x: hidden;
  }

  /* Audio Toggle Button */
  .audio-btn {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 10000;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 215, 0, 0.3);
    color: var(--gold);
    padding: 10px 15px;
    border-radius: 30px;
    cursor: pointer;
    font-family: 'Inter', sans-serif;
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 1px;
    transition: all 0.3s;
    backdrop-filter: blur(5px);
  }
  .audio-btn:hover { background: rgba(255, 215, 0, 0.1); border-color: var(--gold); }

  section {
    height: 100vh;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 20px;
    position: relative;
    scroll-snap-align: start;
    scroll-snap-stop: always;
    overflow: hidden;
  }

  /* Text Styling Enhancements */
  .text {
    max-width: 800px;
    z-index: 2;
    pointer-events: none;
  }

  .main-msg {
    font-family: 'Mountains of Christmas', cursive;
    font-size: clamp(3rem, 8vw, 5rem);
    color: var(--gold);
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
    line-height: 1.2;
    margin-bottom: 20px;
  }

  .sub-msg {
    font-size: clamp(1.2rem, 3vw, 2rem);
    opacity: 0.9;
    font-weight: 300;
    font-style: italic;
  }

  /* Animations */
  .reveal-text span {
    display: inline-block;
    opacity: 0;
    transform: translateY(40px);
    filter: blur(5px);
    transition: all 1s cubic-bezier(0.2, 1, 0.3, 1);
  }

  .reveal-text.active span {
    opacity: 1;
    transform: translateY(0);
    filter: blur(0);
  }

  /* Tree Section */
  #treeSection {
    background: radial-gradient(circle at center, #111122 0%, #050505 80%);
  }

  .tree-hint {
    position: absolute;
    bottom: 12%;
    left: 50%;
    transform: translateX(-50%);
    font-family: 'Mountains of Christmas', cursive;
    font-size: 1.5rem;
    color: rgba(255, 255, 255, 0.6);
    pointer-events: none;
    animation: float 3s ease-in-out infinite;
  }
  @keyframes float { 0%,100%{transform:translate(-50%,0);} 50%{transform:translate(-50%,-10px);} }

  canvas {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    touch-action: none;
  }

  /* Custom Cursor */
  .cursor {
    width: 40px; height: 40px;
    border: 1px solid rgba(255,255,255,0.3);
    border-radius: 50%;
    position: fixed;
    pointer-events: none;
    z-index: 9999;
    transition: transform 0.1s;
    mix-blend-mode: difference;
  }
  .cursor-dot {
    width: 6px; height: 6px;
    background: var(--gold);
    border-radius: 50%;
    position: fixed;
    pointer-events: none;
    z-index: 10000;
  }

  @media (hover: none) { .cursor, .cursor-dot { display: none; } }
</style>
</head>
<body>

<audio id="bgMusic" loop>
  <source src="https://cdn.pixabay.com/download/audio/2022/11/22/audio_febc508520.mp3?filename=christmas-magic-126446.mp3" type="audio/mpeg">
</audio>
<button class="audio-btn" id="audioBtn">Turn Music On</button>

<div class="cursor"></div>
<div class="cursor-dot"></div>

<section>
  <div class="text reveal-text">
    <div class="main-msg" data-text="Hello there"></div>
    <div class="sub-msg" data-text="Turn up your volume..."></div>
  </div>
</section>

<section>
  <div class="text reveal-text">
    <div class="main-msg" data-text="I made this"></div>
    <div class="sub-msg" data-text="...just to see you smile."></div>
  </div>
</section>

<section>
  <div class="emoji-section" style="font-size: 8rem; filter: drop-shadow(0 0 30px rgba(255,215,0,0.3));">üéÅ</div>
</section>

<section id="treeSection">
  <canvas id="treeCanvas"></canvas>
  <div class="tree-hint">Tap the tree to make a wish</div>
</section>

<section class="final-message">
  <div class="text reveal-text">
    <div class="main-msg" data-text="Merry Christmas"></div>
    <div class="sub-msg" data-text="May your 2026 be filled with magic."></div>
  </div>
</section>

<script>
  // --- AUDIO LOGIC ---
  const audio = document.getElementById('bgMusic');
  const btn = document.getElementById('audioBtn');
  audio.volume = 0.4;
  
  btn.addEventListener('click', () => {
    if(audio.paused) {
      audio.play();
      btn.textContent = "Pause Music";
      btn.style.background = "rgba(255, 215, 0, 0.2)";
    } else {
      audio.pause();
      btn.textContent = "Play Music";
      btn.style.background = "";
    }
  });

  // --- TEXT REVEAL LOGIC ---
  document.querySelectorAll('[data-text]').forEach(el => {
    const text = el.getAttribute('data-text');
    el.innerHTML = text.split('').map((char, i) => 
      `<span style="transition-delay: ${i * 0.03}s">${char === ' ' ? '&nbsp;' : char}</span>`
    ).join('');
  });

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) entry.target.parentElement.classList.add('active');
      else entry.target.parentElement.classList.remove('active');
    });
  }, { threshold: 0.5 });
  
  document.querySelectorAll('.main-msg, .sub-msg').forEach(el => observer.observe(el));

  // --- CURSOR LOGIC ---
  const cursor = document.querySelector('.cursor');
  const dot = document.querySelector('.cursor-dot');
  let mouse = { x: -100, y: -100 };
  let cPos = { x: -100, y: -100 };

  document.addEventListener('mousemove', e => { mouse.x = e.clientX; mouse.y = e.clientY; });
  
  function updateCursor() {
    cPos.x += (mouse.x - cPos.x) * 0.1;
    cPos.y += (mouse.y - cPos.y) * 0.1;
    cursor.style.transform = `translate(${cPos.x - 20}px, ${cPos.y - 20}px)`;
    dot.style.transform = `translate(${mouse.x - 3}px, ${mouse.y - 3}px)`;
    requestAnimationFrame(updateCursor);
  }
  updateCursor();

  // --- 3. UPGRADED TREE LOGIC (Spiral & Wishes) ---
  const canvas = document.getElementById('treeCanvas');
  const ctx = canvas.getContext('2d');
  let w, h;
  let stars = [];
  let wishes = [];
  const wishWords = ["Joy", "Love", "Peace", "Hope", "Warmth", "Magic"];

  function resize() { w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; initTree(); }
  window.addEventListener('resize', resize);

  function initTree() {
    stars = [];
    const treeH = Math.min(h * 0.75, 600);
    const treeW = treeH * 0.55;
    const count = window.innerWidth < 600 ? 400 : 800;

    for(let i=0; i<count; i++) {
      const p = i / count;
      const y = (h/2 - treeH/2) + p * treeH;
      const radius = p * treeW;
      
      // SPIRAL LOGIC: Adds structured "garland" effect
      const spiralAngle = p * Math.PI * 15; 
      const randomAngle = Math.random() * Math.PI * 2;
      
      // Mix spiral points and random points
      const isSpiral = Math.random() > 0.5;
      const angle = isSpiral ? spiralAngle : randomAngle;
      
      stars.push({
        y: y,
        baseY: y,
        angle: angle,
        dist: Math.random() * radius, // Fill inside
        speed: 0.005 + Math.random() * 0.01,
        size: Math.random() * 2 + (isSpiral ? 1.5 : 0.5),
        color: isSpiral ? `hsl(${40 + Math.random()*10}, 100%, 60%)` : `hsla(150, 60%, 80%, 0.6)`,
        isSpiral: isSpiral
      });
    }
    // Top Star
    stars.push({ isTop: true, y: (h/2 - treeH/2) - 15, size: 12, angle: 0, dist: 0 });
  }
  
  // --- INTERACTION: WISHES ---
  function spawnWish(x, y) {
    const word = wishWords[Math.floor(Math.random() * wishWords.length)];
    wishes.push({
      x: x, y: y,
      text: word,
      life: 1,
      vy: -2,
      color: `hsl(${Math.random() * 60 + 20}, 100%, 70%)`
    });
  }

  canvas.addEventListener('click', e => {
    const rect = canvas.getBoundingClientRect();
    spawnWish(e.clientX - rect.left, e.clientY - rect.top);
  });
  
  canvas.addEventListener('touchstart', e => {
    e.preventDefault();
    const rect = canvas.getBoundingClientRect();
    spawnWish(e.touches[0].clientX - rect.left, e.touches[0].clientY - rect.top);
  });

  // --- ANIMATION LOOP ---
  function animate() {
    ctx.clearRect(0, 0, w, h);
    const time = Date.now() * 0.0005;
    const center = w / 2;

    // Draw Stars
    stars.forEach(s => {
      if(s.isTop) {
        ctx.fillStyle = "#ffd700";
        ctx.shadowBlur = 30; ctx.shadowColor = "gold";
        ctx.beginPath(); ctx.arc(center, s.y, s.size, 0, Math.PI*2); ctx.fill();
        ctx.shadowBlur = 0; return;
      }

      // Rotate
      const realAngle = s.angle + time;
      const x = Math.cos(realAngle) * s.dist;
      const z = Math.sin(realAngle) * s.dist;
      
      // Perspective
      const scale = 400 / (400 + z);
      const alpha = scale * 0.8; // Fade back
      
      ctx.fillStyle = s.color;
      ctx.globalAlpha = alpha;
      
      // Draw
      ctx.beginPath();
      ctx.arc(center + x * scale, s.y * scale, s.size * scale, 0, Math.PI*2);
      ctx.fill();
    });
    ctx.globalAlpha = 1;

    // Draw Floating Wishes
    ctx.font = "bold 20px 'Mountains of Christmas'";
    ctx.textAlign = "center";
    for(let i = wishes.length - 1; i >= 0; i--) {
      let w = wishes[i];
      w.y += w.vy;
      w.life -= 0.01;
      
      if(w.life <= 0) { wishes.splice(i, 1); continue; }
      
      ctx.fillStyle = w.color;
      ctx.globalAlpha = w.life;
      ctx.fillText(w.text, w.x, w.y);
      ctx.globalAlpha = 1;
    }

    requestAnimationFrame(animate);
  }
  
  resize();
  animate();
</script>
</body>
</html>
